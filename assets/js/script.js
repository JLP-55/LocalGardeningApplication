var apiKey = "sk-fKLP65a1e36e3cacb3763";
var getApiKey = "https://perenual.com/api/species-list?key=" + apiKey;
var userInput = document.getElementById("user-input");
var searchBtn = document.getElementById("search-button");
var appendParameters = document.getElementById("parameters-boolean-values");
// var trialAppend = document.getElementById("remove");

var parametersBtnSunlight = document.getElementById("Sunlight");
parametersBtnSunlight.addEventListener("click", parametersArrayContentPlus);
var parametersBtnCycle = document.getElementById("Cycle");
parametersBtnCycle.addEventListener("click", parametersArrayContentPlus);
var parametersBtnWatering = document.getElementById("Watering");
parametersBtnWatering.addEventListener("click", parametersArrayContentPlus);

var keyWord =  "https://perenual.com/api/species-list?key=" + apiKey;
var keyWordUserSearch = "&q=";

// This is the section of code relevant to the parameters buttons with boolean values.
// Sets attribute and adds event listener.
for (let i = 0; i < parametersArray.length; i++) {
    var parametersBtnBoolean = document.body.children[1].children[1].children[i];
    parametersBtnBoolean.setAttribute("id", parametersArray[i].content);
    parametersBtnBoolean.addEventListener("click", userParameters);
};

// Use this function to generate all of the "four values" buttons.
function parametersArrayContentPlus (event) {
    var parametersBtnSunlight = parametersArraySunlight[1].content;
    var parametersBtnCycle = parametersArrayCycle[1].content;
    var parametersBtnWatering = parametersArrayWatering[1].content;
    
    console.log(event.target.textContent);

    // Ensures that the content generated by the four values buttons doesn't keep generating.
    document.getElementById("four-values-append-sunlight").innerHTML = "";
    document.getElementById("four-values-append-cycle").innerHTML = "";
    document.getElementById("four-values-append-watering").innerHTML = "";

    if (parametersBtnSunlight == event.target.textContent) {
        for (let i = 0; i < 4; i++) {
            var parametersBtnSunlightApiAdd = document.createElement("button");
            parametersBtnSunlightApiAdd.textContent = parametersArraySunlight[3].contentPlus[i];
            parametersBtnSunlightApiAdd.setAttribute("class", "all-parameters");
            parametersBtnSunlightApiAdd.setAttribute("id", parametersArraySunlight[3].contentPlus[i]);
            document.getElementById("four-values-append-sunlight").appendChild(parametersBtnSunlightApiAdd);
            parametersBtnSunlightApiAdd.addEventListener("click", sunlightParametersAdd);
            document.getElementById("four-values-append-sunlight").setAttribute("style", "visibility: visible;")
        };
    } else if (parametersBtnCycle == event.target.textContent) {
        for (let i = 0; i < 4; i++) {
            var parametersBtnCycleApiAdd = document.createElement("button");
            parametersBtnCycleApiAdd.textContent = parametersArrayCycle[3].contentPlus[i];
            parametersBtnCycleApiAdd.setAttribute("class", "all-parameters");
            parametersBtnCycleApiAdd.setAttribute("id", parametersArrayCycle[3].contentPlus[i]);
            document.getElementById("four-values-append-cycle").appendChild(parametersBtnCycleApiAdd);
            parametersBtnCycleApiAdd.addEventListener("click", cycleParametersAdd);
            document.getElementById("four-values-append-cycle").setAttribute("style", "visibility: visible;")
        };
    } else if (parametersBtnWatering == event.target.textContent) {
        for (let i = 0; i < 4; i++) {
            var parametersBtnWateringApiAdd = document.createElement("button");
            parametersBtnWateringApiAdd.textContent = parametersArrayWatering[3].contentPlus[i];
            parametersBtnWateringApiAdd.setAttribute("class", "all-parameters");
            parametersBtnWateringApiAdd.setAttribute("id", parametersArrayWatering[3].contentPlus[i]);
            document.getElementById("four-values-append-watering").appendChild(parametersBtnWateringApiAdd);
            parametersBtnWateringApiAdd.addEventListener("click", wateringParametersAdd);
            document.getElementById("four-values-append-watering").setAttribute("style", "visibility: visible;")
        };
    };
};

// This function handles the logic related to the parameters buttons with boolean values.
function userParameters (event) {
    var parametersInput = event.target.textContent;

    // This for loop will add the user input into the api query for all the parameters buttons with boolean values.
    for (var i = 0; i < parametersArray.length; i++) {
        // console.log(parametersArray[i].content);
        // The parametersInput variable must have a loose equality to the content variable of whatever index the for loop is currently iterating through in the parameters array.
        if (parametersInput == parametersArray[i].content) {
            keyWord = keyWord + parametersArray[i].addToParameters;
        };
    };

    console.log(parametersInput);
    console.log(keyWord);
};

// Add the "sunlight" search parameters to the variable keyword.
function sunlightParametersAdd (event) {
    var userParameters = event.target.textContent;
    console.log(userParameters);
    for (let i = 0; i < parametersArraySunlight.length; i++) {
        if (userParameters == parametersArraySunlight[3].contentPlus[i]) {
            keyWord = keyWord + parametersArraySunlight[0].addToParameters[i];
            console.log(keyWord);
        };
    };
};

// Add the "cycle" search parameters to the variable keyword.
function cycleParametersAdd (event) {
    var userParameters = event.target.textContent;
    console.log(userParameters);
    for (let i = 0; i < parametersArrayCycle.length; i++) {
        if (userParameters == parametersArrayCycle[3].contentPlus[i]) {
            keyWord = keyWord + parametersArrayCycle[0].addToParameters[i];
            console.log(keyWord);
        };
    };
};

// Add the "watering" search parameters to the variable keyword.
function wateringParametersAdd (event) {
    var userParameters = event.target.textContent;
    console.log(userParameters);
    for (let i = 0; i < parametersArrayWatering.length; i++) {
        if (userParameters == parametersArrayWatering[3].contentPlus[i]) {
            keyWord = keyWord + parametersArrayWatering[0].addToParameters[i];
            console.log(keyWord);
        };
    };
};

// This function handles the api call.
function searchDatabase () {
    // Checks to see if the textbox is empty or not so as to add the user imput to the api query.
    // How do you remove spaces in the user input? .trim()? It's not working
    if (userInput.value !== "") {
        keyWord = keyWord.concat(keyWordUserSearch).concat(userInput.value.trim());
        console.log(keyWord);
        // console.log(userInput.value);
    };
    fetch(keyWord)
        .then(function (response) {
            return response.json();
        })
        .then(function (data) {
            // console.log(data.data[1]);
            console.log(data);
        });
        console.log(keyWord);
        // console.log(userInput.value);
};
  
// parametersBtn.addEventListener("click", callParameters);
searchBtn.addEventListener("click", searchDatabase);